{%- if include.id -%}
  {%- assign gallery = page[include.id] -%}
  {%- assign galleryName = include.id -%}
{%- else -%}
  {%- assign gallery = page.gallery -%}
  {%- assign galleryName = 'image-gallery' -%}
{%- endif -%}

{%- if include.layout -%}
  {% assign gallery_layout = include.layout %}
{%- else -%}
  {%- if gallery.size == 2 -%}
    {% assign gallery_layout = 'half' %}
  {%- elsif gallery.size >= 3 -%}
    {% assign gallery_layout = 'third' %}
  {%- else -%}
    {% assign gallery_layout = '' %}
  {%- endif -%}
{%- endif -%}

{%- if gallery_layout == 'half' -%}
  {%- assign element_class = 'w-1/2' -%}
{%- elsif gallery_layout == 'third' -%}
  {%- assign element_class = 'w-1/2 md:w-1/3' -%}
{%- else -%}
  {%- assign element_class = 'w-full' -%}
{%- endif -%}

<figure class="flex flex-wrap {{galleryName}}">
  {% for img in gallery %}
      <a href="{{ img.image_path | relative_url }}" class="flex-none p-1.5 {{ element_class }}">
        {% cloudinary thumbnail {{ img.image_path | relative_url }} %}
      </a>
  {% endfor %}
  {% if include.caption %}
    <figcaption>{{ include.caption | markdownify | remove: "<p>" | remove: "</p>" }}</figcaption>
  {% endif %}
</figure>

<script>
    new SimpleLightbox({elements: '.{{galleryName}} a'});
</script>